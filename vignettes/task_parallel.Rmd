---
title: "autoparallel-task-parallel"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{autoparallel-task-parallel}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Task Parallel

Parallel infrastructure for computing on data generally centers around data
parallelism. This means to call the same function on many
different data (SIMD).

Independent tasks are also amenable to running in parallel. This is task
parallelism. It means to call different functions on different data
simultaneously.

This can be done today through R's included `parallel` package:


```{R}

library(parallel)

# Begins asynchronous evaluation of rnorm(10)
mcparallel(expr = rnorm(10))

# This can happen before the above expression is finished
x = rnorm(20)

# Collect the result from all parallel workers
y = mccollect()[[1]]

```

This introduces overhead compared to standard serial evaluation, but it may
speed up the program if the following conditions hold:

- The system has available computing resources. This may not be the case
  for linear algebra intensive work with a multithreaded BLAS / LAPACK,
  which is included with versions of R such as [Microsoft R
  Open](https://mran.microsoft.com/rro/#intelmkl1).
- There are two or more long running tasks that can occur simultaneously.
  For a multicore fork based approach the tasks should take at least 10 ms,
  and [preferably much
  longer](https://www.kernel.org/pub/linux/kernel/people/paulmck/perfbook/perfbook.html).
- At least one task returns a relatively small object. This allows one to
  avoid the cost of serializing R objects between processes. For example,
  it takes hundreds of milliseconds to serialize a vector of 10 million integers.

TODO: Estimate more precisely the costs of serialization. Is it much cheaper
to do it directly vs using `mccollect()`?

## Ideas

Write a function to check if code is IO bound.

Are there cheaper ways to share read only copies of objects between
processes in R? There's `bigmemory`, but what about something a little more
generalized like the plasma object store?
